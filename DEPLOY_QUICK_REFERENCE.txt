╔══════════════════════════════════════════════════════════════════════════════╗
║                    Axon 部署到 sunnyding.cn - 快速参考卡                       ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────────────────────────────────────────────────────────────┐
│ 📖 从这里开始                                                                  │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  1. 阅读部署总结                                                               │
│     📄 DEPLOYMENT_SUMMARY.md                                                 │
│                                                                              │
│  2. 快速部署指南 (推荐) ⭐                                                      │
│     📄 QUICK_DEPLOY.md                                                       │
│                                                                              │
│  3. 部署前检查清单                                                             │
│     ☑️  DEPLOYMENT_CHECKLIST.md                                              │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 🚀 三步部署 (Linux/Ubuntu)                                                     │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  步骤 1: 上传项目                                                              │
│  $ scp -r ./mynotebookllmwebsite user@server:/tmp/axon                       │
│                                                                              │
│  步骤 2: 运行部署脚本                                                           │
│  $ ssh user@server                                                           │
│  $ sudo mv /tmp/axon /var/www/axon                                          │
│  $ cd /var/www/axon && chmod +x deploy.sh && sudo ./deploy.sh               │
│                                                                              │
│  步骤 3: 配置 API 密钥                                                         │
│  $ sudo nano /var/www/axon/backend/.env                                     │
│  # 填入: DEEPSEEK_API_KEY=your_key                                           │
│  $ sudo systemctl restart axon-backend                                      │
│                                                                              │
│  ✅ 完成！访问 https://sunnyding.cn                                            │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 📁 核心文件                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  配置文件:                                                                     │
│    • nginx.conf                    Nginx 配置                                │
│    • axon-backend.service          后端服务配置                               │
│    • frontend/config.js            前端环境配置 (自动适配)                      │
│    • backend/.env.example          后端环境变量模板                            │
│                                                                              │
│  部署脚本:                                                                     │
│    • deploy.sh                     Linux 自动部署                             │
│    • deploy.ps1                    Windows 部署                              │
│                                                                              │
│  文档:                                                                        │
│    • DEPLOYMENT_SUMMARY.md         部署准备总结 ⭐                             │
│    • QUICK_DEPLOY.md               快速部署指南 ⭐                             │
│    • DOMAIN_DEPLOYMENT.md          完整部署文档                                │
│    • DEPLOYMENT_CHECKLIST.md       检查清单                                   │
│    • DEPLOYMENT_README.md          文件说明                                   │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 🔍 验证部署                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  检查服务:                                                                     │
│  $ sudo systemctl status nginx                                               │
│  $ sudo systemctl status axon-backend                                        │
│                                                                              │
│  测试 API:                                                                    │
│  $ curl http://localhost:8000/health                                         │
│  $ curl https://sunnyding.cn/api/health                                     │
│                                                                              │
│  查看日志:                                                                     │
│  $ sudo tail -f /var/log/nginx/error.log                                    │
│  $ sudo journalctl -u axon-backend -f                                        │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ ⚙️ 常用命令                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  重启服务:                                                                     │
│  $ sudo systemctl restart nginx                                              │
│  $ sudo systemctl restart axon-backend                                       │
│                                                                              │
│  SSL 证书:                                                                    │
│  $ sudo certbot --nginx -d sunnyding.cn -d www.sunnyding.cn                 │
│  $ sudo certbot renew                                                        │
│                                                                              │
│  更新代码:                                                                     │
│  $ cd /var/www/axon/backend                                                  │
│  $ source venv/bin/activate                                                  │
│  $ pip install --upgrade -r requirements.txt                                 │
│  $ sudo systemctl restart axon-backend                                       │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 🔒 DNS 配置                                                                   │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  在域名提供商添加以下记录:                                                       │
│                                                                              │
│  类型    主机记录    记录值                                                     │
│  ────    ────────   ────────                                                │
│  A       @          服务器公网IP                                               │
│  A       www        服务器公网IP                                               │
│                                                                              │
│  验证 DNS:                                                                    │
│  $ nslookup sunnyding.cn                                                     │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 🛠️ 故障排查                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  502 Bad Gateway:                                                            │
│  • 检查后端是否运行: sudo systemctl status axon-backend                         │
│  • 查看后端日志: sudo journalctl -u axon-backend -n 50                         │
│                                                                              │
│  域名无法访问:                                                                  │
│  • 检查 DNS: nslookup sunnyding.cn                                            │
│  • 检查防火墙: sudo ufw status                                                 │
│  • 检查 Nginx: sudo nginx -t                                                  │
│                                                                              │
│  SSL 证书失败:                                                                 │
│  • 确保域名已解析到服务器                                                        │
│  • 确保 80 端口可访问                                                           │
│  • 检查 Certbot 日志: sudo certbot certificates                               │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 📝 需要准备                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ☑️  服务器公网 IP 地址                                                         │
│  ☑️  SSH 登录权限                                                              │
│  ☑️  域名 sunnyding.cn                                                        │
│  ☑️  DeepSeek API 密钥                                                        │
│  ☑️  开放 80, 443 端口                                                        │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 🎯 部署架构                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  用户 → HTTPS (443) → Nginx → 前端静态文件                                      │
│                           ↓                                                  │
│                        /api → 后端 (localhost:8000)                           │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 🌐 访问地址                                                                    │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  主站:      https://sunnyding.cn                                             │
│  带 WWW:   https://www.sunnyding.cn (自动重定向)                              │
│  API:      https://sunnyding.cn/api/                                        │
│  健康检查:  https://sunnyding.cn/api/health                                   │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║  💡 提示: 首次部署请先阅读 DEPLOYMENT_SUMMARY.md 了解全貌                        ║
║  🚀 快速上手请直接参考 QUICK_DEPLOY.md                                          ║
║  📖 遇到问题查看 DOMAIN_DEPLOYMENT.md 故障排查章节                               ║
╚══════════════════════════════════════════════════════════════════════════════╝
